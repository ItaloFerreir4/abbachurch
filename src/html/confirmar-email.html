@SPK@include("partials/mainhead.html")

</head>

<style>
    .alert.alert-success {
        background-color: #206a1147;
        font-size: 16px;
        color: #fff;
        text-align: center;
        border: none;
        padding: 20px;
    }

    .alert.alert-danger {
        background-color: #6a1b1147;
        font-size: 16px;
        color: #fff;
        text-align: center;
        border: none;
        padding: 20px;
    }

</style>

<body>
    @SPK@include("partials/switcher.html")
    @SPK@include("partials/loader.html")

    <div class="row mx-0 authentication">

        <div class="col-xxl-6 col-xl-7 col-lg-12">
            <div class="row mx-0 justify-content-center align-items-center h-100">
                <div class="col-xxl-6 col-xl-7 col-lg-7 col-md-7 col-sm-8 col-12">
                    <div class="p-sm-5 p-0">
                        <div class="col-12 d-grid mb-2 px-0">
                            <!-- <a href="voluntariar" class="btn btn-lg btn-primary">Clique aqui para fazer o login</a> -->
                            <div id="result-email"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xxl-6 col-xl-5 col-lg-5 d-xl-block d-none px-0">
            <div class="authentication-cover">
                <div class="">
                    <div class="row justify-content-center g-0">
                        <div class="col-xl-9">
                            <a href="/index"> <img src="../assets/images/brand-logos/desktop-dark.png" alt="" class="authentication-brand cover-dark-logo op-9"></a>                         
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    
    <!-- Custom JS -->
    <script src="../assets/js/custom.js"></script>

</body>

<script>

    window.addEventListener("load", function() {
        IniLoader();
        var url = window.location.href;
        var token = url.split("t=")[1];
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/confirmar-email", true);
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4) {
                FinLoader();
                if (xhr.status === 200) {
                
                    var response = JSON.parse(xhr.responseText);
                    var message = response.message;
                    document.getElementById("result-email").innerHTML = "<div style='text-align: center;'><div class='alert alert-success' role='alert'><i class='bi bi-check2-circle'></i> " + message + "</div><a href='/login' class='text-primary'>Clique aqui para fazer o login</a></div>";
                    
                } else if (xhr.status === 401) {
                
                    var response = JSON.parse(xhr.responseText);
                    var message = response.message;
                    document.getElementById("result-email").innerHTML = "<i class='bi bi-x-circle'></i><div class='alert alert-danger' role='alert'>" + message + "</div>";
                
                } else {
                    document.getElementById("result-email").innerHTML = "<i class='bi bi-x-circle'></i><div class='alert alert-danger' role='alert'>Erro ao confirmar cadastro!</div>";
                    console.error(xhr);
                }
            }
        };
        xhr.send("token=" + token);
    });

</script>

</html>