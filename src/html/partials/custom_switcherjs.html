
<!-- Custom-Switcher JS -->
<script src="../assets/js/custom-switcher.min.js"></script>

<!-- Select2 Cdn -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>


<script>
    window.addEventListener("load", function(){
        const tipoUser = sessionStorage.getItem('tipoUser');
        hideElementsBasedOnUserRole(tipoUser);
    });

    $('.single-select').select2({
        dir: "ltr"
    });

    $('.multiple-select').select2({
        dir: "ltr"
    });

    if(document.querySelector(".datetime")){
        flatpickr(".datetime", {
            enableTime: true,
            dateFormat: "Y-m-d h:i K",
        });

    }

    function IniLoader(){
        const loader = document.getElementById("loader");
        loader.classList.remove('d-none');
    }

    function FinLoader(){
        console.log('teste');
        Promise.all([TraduzirFront()])
        .then(function () {
            const loader = document.getElementById("loader");
            loader.classList.add('d-none');
            console.log('teste2');
        })
        .catch(function (error) {
            console.error('Erro:', error);
            const loader = document.getElementById("loader");
            loader.classList.add('d-none');
        });       

    }

    function formatarDataHora(data) {
        const options = {
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            hour12: true
        };

        const formato = new Intl.DateTimeFormat('en-US', options).format(data);

        // Dividir a string em partes usando uma expressão regular
        const partes = formato.match(/(\d{1,2})\/(\d{1,2})\/(\d{4}), (\d{1,2}):(\d{2}) ([APMapm]{2})/);

        if (!partes) {
            throw new Error('Formato de data inválido');
        }

        // Extrair componentes da data
        const [, month, day, year, hour, minute, period] = partes;

        // Formatar a data no novo formato
        const novaDataFormatada = `${year}-${month}-${day} ${hour}:${minute} ${period.toUpperCase()}`;

        return novaDataFormatada;
    }

    function hideElementsBasedOnUserRole(tipoUser) {
        const elements = document.querySelectorAll('.restricao'); // Substitua 'your-target-elements' com o seletor CSS desejado para seus elementos

        elements.forEach(element => {
            const elementClasses = element.classList;

            // Verifica se há pelo menos uma classe restrita ao tipo de usuário
            let hideElement = true;

            if (
                (elementClasses.contains('admin') && tipoUser === '0') ||
                (elementClasses.contains('pastor') && tipoUser === '1') ||
                (elementClasses.contains('lider') && tipoUser === '2') ||
                (elementClasses.contains('ministerios') && tipoUser === '3') ||
                (elementClasses.contains('voluntarios') && tipoUser === '4') ||
                (elementClasses.contains('admin') && tipoUser === '5')
            ) {
                hideElement = false;
            }

            // Se pelo menos uma classe corresponder, mantenha o elemento visível
            if (!hideElement) {
                element.style.display = 'block'; // Ou você pode definir como 'initial' para usar o estilo padrão
            } else {
                // Se nenhuma classe corresponder, oculte o elemento
                element.style.display = 'none';
            }
        });
    }

    function verificacaoCampos(excludedFields, field) {
        const campos = {
            'nomePessoa': 'Nome',
            'emailPessoa': 'Email',
            'telefonePessoa': 'Telefone',
            'estadoCivilPessoa': 'Estado Civil',
            'dataNascimentoPessoa': 'Data de Nascimento',
            'profissaoPessoa': 'Profissão',
            'escolaridadePessoa': 'Escolaridade',
            'idiomaPessoa': 'Idiomas',
            'nacionalidadePessoa': 'Nacionalidade',
            'pastorId': 'Pastor Responsável',
            'generoPessoa': 'Gênero',
            'categoriasVoluntario': 'Habilidades',
            'nomeCategoriaEvento': 'Nome',
            'nomeEvento': 'Nome',
            'localEvento': 'Local',
            'dataHoraInicioEvento': 'Data/Hora Inicio',
            'dataHoraFimEvento': 'Data/Hora Fim',
            'categoriaEventoId': 'Categoria',
            'ministerioId': 'Ministério',
            'observacoesEvento': 'Observações',
            'nomeCategoria': 'Categoria',
            'nomeIgreja': 'Nome',
            'paisIgreja': 'País',
            'estadoIgreja': 'Estado',
            'enderecoIgreja': 'Endereço',
            'cepIgreja': 'CEP',
            'telefoneIgreja': 'Telefone',
            'emailIgreja': 'Email',
            'tipoIgreja': 'Tipo',
            'matrizId': 'Matriz',
            'nomeMinisterio': 'Nome',
            'liderId': 'Líder',
            'dataEntradaMinisterio': 'Data',
            'igrejaId': 'Igreja',
            'classificacaoRequisicao': 'Classificação',
            'informacoesRequisicao': 'Informações',
            'voluntarioId': 'Voluntário',
            'categoria': 'Habilidade',
        };

        if (!excludedFields.includes(field.name)) {
            if (field.value.trim() === '' || field.value.trim() === 'Selecione uma opção') {
                return { fieldName: field.name, fieldLabel: campos[field.name] };
            } else {
                return null;  // Retorna null para campos não vazios
            }
        } else {
            return null;  // Retorna null para campos excluídos
        }
    }

    function TraduzirFront(){
        return new Promise(function (resolve, reject) {

            const elementosParaTraduzir = document.querySelectorAll(".translate");
            
            if(elementosParaTraduzir.length){
                const formData = [];
                formData.push({ name: 'idiomaOrigem', value: 'pt' });
                formData.push({ name: 'idiomaDestino', value: 'en' });
                formData.push({ name: 'textoOriginal', value: '' });
    
                elementosParaTraduzir.forEach(async (elemento) => {
    
                    
                    const textoOriginal = elemento.innerText;
                    console.log(textoOriginal);
                    
                    const indexTextoOriginal = formData.findIndex(item => item.name === 'textoOriginal');
                    formData[indexTextoOriginal].value = textoOriginal;
    
                    resolve(true);
    
                    // $.post('api/traduzirElemetos', formData)
                    //     .done(function (data) {
                            
                    //         elemento.innerText = data;
    
                    //         resolve(true);
    
                    //     })
                    //     .fail(function (error) {
    
                    //         console.error('Erro na requisição:', error);
    
                    //         message = error.responseJSON.message ? error.responseJSON.message : 'Erro ao cadastrar!';
    
                    //         Swal.fire({
                    //             position: 'center',
                    //             icon: 'error',
                    //             title: message,
                    //             showConfirmButton: false,
                    //             timer: 1500
                    //         });
    
                    //         reject(error);
    
                    //     });
                });
            }
            else{
                resolve(true);
            }

        });
    }

</script>